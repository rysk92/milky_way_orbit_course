# 軌道要素

さて、今まで軌道計算に必要な基本的な要素を学んできました。

今回からは、いよいよ今まで利用した要素を利用して特定の日の軌道の計算を行います。

## 軌道上の位置の決定

4章でのケプラーの法則の第二法則を確認します。

> 面積速度一定の法則: 惑星と太陽を結ぶ線分が時間単位に書く面積は、一定である。

この法則は、**面積一定の法則** とも呼びます。

以下の図で、一定の時間を t とします。

惑星はt時間をかけて、点Aから点Bまで移動します。一方で、別の時間に惑星はt時間かけて点Cから点Dまで移動します。

この時、同じ時間をかけて移動することによって出来た面ABFと面CDFは、同じ面積になるというものです。
これが第二法則です。

### 平均近点角

第二法則を利用すると、以下の式を作ることが出来ます。これを**ケプラーの運動方程式**と呼びます。

![](./images/6_m_1.svg)

- M: 平均近点角
- e: 離心率
- E: 離心近点角

この式が成り立つ課程について詳しく知りたい場合は、楕円軌道とケプラー方程式<sup>[1](#note1)</sup>をご確認ください。

平均近点角とは、近日点を通過してからの経過時間を軌道周期(太陽の回りを周るのにかかる時間)に対する割合として示すものです。

平均近点角は、惑星や衛星の質量などから求める事ができますが、今回は予め観測された情報として平均近点角・離心率を知ることができるため、そちらを利用します。

平均近点角(M)と離心率(e)を知っている場合、離心近点角(E)を求めることが出来ます。
離心近点角(E)から4章で学んだ式を利用して具体的な惑星の位置を計算により特定します。

### 平均近点角から惑星の位置を求める

実際のデータを利用して、地球の位置を求めてみましょう。

NASAが公開している、データ [Keplerian Elements for Approximate Positions of the Major Planets](https://ssd.jpl.nasa.gov/?planet_pos)
を使いましょう。このデータは、J2000.0ベースで軌道の計算するためのデータが記述されています。

それぞれの惑星の軸や変数は徐々に移動します。従って、1800年から2050年のデータを使います。ページ下の Keplerian Elements for 1800AD to 2050ADを確認しましょう。

以下のような記述があります。

```
               a              e               I                L            long.peri.      long.node.
           AU, AU/Cy     rad, rad/Cy     deg, deg/Cy      deg, deg/Cy      deg, deg/Cy     deg, deg/Cy
-----------------------------------------------------------------------------------------------------------
Mercury   0.38709927      0.20563593      7.00497902      252.25032350     77.45779628     48.33076593
          0.00000037      0.00001906     -0.00594749   149472.67411175      0.16047689     -0.12534081
Venus     0.72333566      0.00677672      3.39467605      181.97909950    131.60246718     76.67984255
          0.00000390     -0.00004107     -0.00078890    58517.81538729      0.00268329     -0.27769418
EM Bary   1.00000261      0.01671123     -0.00001531      100.46457166    102.93768193      0.0
          0.00000562     -0.00004392     -0.01294668    35999.37244981      0.32327364      0.0
...
```

地球はEM Bary (月と地球の重心) です。従って、計算結果は実際の地球の場所より少しばかりズレます。
惑星のデータはそれぞれに対して、2行あり以下のデータが横に並んでいます。1行目は、J2000.0時点のデータで、
2行目は時間経過による変化量をユリウス世紀単位で示しています。

- a: 軌道の半長径 (単位: AU)
- e: 軌道の離心率 (単位: ラジアン)
- I: 黄道面と軌道面の角度 (単位: 度, 次の章で利用)
- L: 平均経度 (単位: 度): 黄経。地球は1年間で360度回り、10年でおおよそ360,000度回るデータとなっている。
- long.peri: 近日点黄経 (![varpi](./images/varpi.svg) 単位: 度): 近日点の黄経を示す。
- long.node: 昇交点黄経 (Ω 単位: 度): 軌道が行動面を南側から北側に横切る位置(昇交点)の太陽を中心とした黄経。(次の章で利用)
地球の場合は、黄道面と軌道面が一致してしまうので、0としている。

平均近点角Mは、近日点からの角度のため

![](./images/6_m_2.svg)

より求めることが出来ます。

Mを出すことが出来たため、ここからEを計算して軌道中のどこに惑星があるかを求めることが出来ます。

2015年1月30日 日本時間9:00時点での水星(Mercury)の、楕円軌道上の位置を求めてみます。

まずは、ユリウス世紀数を求めます。[計算サイト](https://keisan.casio.jp/exec/system/1526003938)で確認すると、この時間のUNIX時間は、`1422576000` です。
ここからユリウス日を求めるので、2章から、 UNIX時間 / 86400 + 2440587.5 から、`2457052.5` という数値が出てきます。
ユリウス日から、ユリウス世紀数を求めるには、(ユリウス日 - 2451545) / 36525 となるため、`0.1507871321` という数値になります。これをTとおきます。

そして、この時間時点での、要素を計算していきます。J2000時点の情報に、ユリウス世紀数ごとの変化量とTをかけ合わせた数値を足し合わせます。
まずは、Lと、long.peri について計算します。

- L: 252.2503235 + 149472.67411175 * 0.1507871321 = 22790.80618 (度)
- long.peri: 77.45779628 + 0.16047689 * 0.1507871321 = 77.48199413 (度)

ここから、Mを求めます。

![](./images/6_m_3.svg)

となり、Mは、`22713.32419` (度) であることがわかります。

次に、eの値も同様にユリウス世紀数を利用し計算します。

- e: 0.20563593 + 0.00001906 * 0.1507871321 = 0.205638804 (ラジアン)

これと、先程求めたMの値がわかると、ケプラーの運動方程式を利用することで、以下の式を作ることができます。ただし、Mの値は度数法となっているため、
統一と、コンピューター上で扱いやすくするために弧度法(ラジアン)に変換します。

- 22713.32419 * π / 180 = 396.4222911 (ラジアン)

![](./images/6_m_4.svg)

この方程式について、Eの値を求めることで、5章で学んだ楕円軌道上のどこに星があるか(x, yの位置)を求めることができます。

これをコンピューターで計算するために、4章で学んだニュートン法を利用します。ケプラーの運動方程式を微分すると、以下の式になります。

![](./images/6_m_5.svg)

これをニュートン法に当てはめて、以下のようなJavaScriptコードを記載し、実行してみます。


```js
const M = 396.4222911 // rad
const e = 0.205638804 // rad
let E = M // Mを初期値とする
let deltaE = null
do {
  deltaE = (E - e * Math.sin(E) - M) / (1 - e * Math.cos(E))
  E -= deltaE
  console.log(E)
} while (deltaE < -0.000001 || 0.000001 < deltaE)
console.log(E)
```

これにより、以下の値が求められました。

- E = 396.55737542242724 (rad)

ここまで来れば、aの値から、x, yを求めることができます。

- a: 0.38709927 + 0.00000037 * 0.1507871321 = 0.3870993258 (AU)

5章より、

![](./images/6_m_6.svg)

のため、以下のコードにより求めることができます。

```js
const e = 0.205638804 // rad
const E = 396.55737542242724 // rad
const a = 0.3870993258
const x = a * (Math.cos(E) - e)
const y = a * Math.sqrt(1 - e * e) * Math.sin(E)
console.log(x, y)
```

これで、

- x = 0.21226130652594014 (AU)
- y = 0.24885129984675164 (AU)

と平面上の座標が求められました。

ここでは水星のみの位置を求めましたが、実際に描画する場合は、他の惑星との位置関係などを考える必要があるため、
地球と太陽の関係から、どの程度面が回転しているかを考慮する必要があります。

次の章では、ここで求めた値を、立体空間上に変換する方法を考えます。

# 注釈

<sup id="note1">1</sup>: http://fnorio.com/0158Kepler_equation/Kepler_equation.html

# 参考文献・引用

- 長谷川一郎 『[天文計算入門](https://www.amazon.co.jp/%E5%A4%A9%E6%96%87%E8%A8%88%E7%AE%97%E5%85%A5%E9%96%80%E2%80%95%E4%B8%80%E7%90%83%E9%9D%A2%E4%B8%89%E8%A7%92%E3%81%8B%E3%82%89%E8%BB%8C%E9%81%93%E8%A8%88%E7%AE%97%E3%81%BE%E3%81%A7-%E9%95%B7%E8%B0%B7%E5%B7%9D-%E4%B8%80%E9%83%8E/dp/4769908180)』 恒星社, 新装版 2015年 (初版1978年) , pp. 148 - 159

# 参考URL

- [軌道要素 - Wikipedia](https://ja.wikipedia.org/wiki/%E8%BB%8C%E9%81%93%E8%A6%81%E7%B4%A0)
